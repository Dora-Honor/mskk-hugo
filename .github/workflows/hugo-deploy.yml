name: Deploy Hugo to GitHub Pages

# 代码提交到 main 分支时触发 GitHub Actions
on:
  workflow_dispatch:
  push:
    branches:
      - main
  schedule:
    - cron: '0 * * * *'  # 每天每小时触发一次

jobs:
  deploy:
    runs-on: ubuntu-latest
    steps:
        - name: Checkout
          uses: actions/checkout@v4
          with:
              fetch-depth: 0

        - name: Setup Hugo
          uses: peaceiris/actions-hugo@v3
          with:
              hugo-version: "latest"
              extended: true

        - name: Build Web
          run: hugo -D

        - name: Deploy Web
          uses: peaceiris/actions-gh-pages@v4
          with:
              personal_token: ${{ secrets.HUGO_DEPLOY }}
              external_repository: Dora-Honor/mskk-hugo
              publish_branch: gh-pages
              publish_dir: ./public
              commit_message: Auto deploy